<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>STAGE - Quick Geometry Viewer</title>
        <style>
            svg {
                border-style: solid;
                border-width: 1px;
                border-color: #ccc;
            }
        </style>
    </head>

    <body>
        <div id="map"></div>
        <script type="text/javascript" src="libs/d3.min.js"></script>
        <!-- <script type="text/javascript"  src="libs/d3.geo.tile.js"></script> -->

        <script>
            var width = Math.max(960, window.innerWidth),
                    height = Math.max(500, window.innerHeight);
            var map = void 0;
            var mapData = void 0;
            var zoom;
            var raster;
            
            function loadScript(){
                var projection = d3.geo.mercator();
                var path = d3.geo.path().projection(projection);
    
                var svg = d3.select("#map")
                        .append("svg")
                        .attr("width", width)
                        .attr("height", height);
    
                var dataStr = getJsonData();
                var data = JSON.parse(dataStr);
                
                var b, s, t;
                projection.scale(1).translate([0, 0]);
                var b = path.bounds(data);
                var s = .9 / Math.max((b[1][0] - b[0][0]) / width, (b[1][1] - b[0][1]) / height);
                var t = [(width - s * (b[1][0] + b[0][0])) / 2, (height - s * (b[1][1] + b[0][1])) / 2];
                projection.scale(s).translate(t);
    
                map = svg.append('g').attr('class', 'boundary');
                mapData = map.selectAll('path').data(data.features);
    
                var paths = mapData.enter()
                        .append('path')
                        .attr('d', path);
    
                paths.attr('stroke', "steelblue")
                        .attr('stroke-linejoin', "round")
                        .attr('fill', function (d) {
                            if (d.geometry.type.endsWith("Polygon")
                                    || d.geometry.type.endsWith("Point")) {
                                return "steelblue";
                            } else {
                                return "none";
                            }
                        })
                        .attr('fill-opacity', function (d) {
                            return  "0.2";
                        });
            }

        </script>
    </body>